# Generated by OmopViewer 0.2.0
# Be careful editing this file

ui <- bslib::page_navbar(
  title = shiny::tags$span(
    shiny::tags$img(
      src = "ohdsi_logo.svg",
      width = "auto",
      height = "46px",
      class = "me-3",
      alt = "logo"
    ),
    ""
  ),
  theme = bslib::bs_theme(),
  bslib::nav_panel(
    title = "Background",
    icon = shiny::icon("disease"),
    backgroundCard("background.md")
  ),
  bslib::nav_panel(
    title = "Summary",
    icon = shiny::icon("file-alt"),
    summaryCard(data)
  ),
  bslib::nav_panel(
    title = "Snapshot",
    icon = shiny::icon("clipboard-list"),
    bslib::layout_sidebar(
      sidebar = bslib::sidebar(
        bslib::accordion(
          bslib::accordion_panel(
            title = "Grouping",
            shinyWidgets::pickerInput(
              inputId = "summarise_omop_snapshot_grouping_cdm_name",
              label = "Cdm name",
              choices = filterValues$summarise_omop_snapshot_grouping_cdm_name,
              selected = filterValues$summarise_omop_snapshot_grouping_cdm_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          ),
          bslib::accordion_panel(
            title = "Variables",
            shinyWidgets::pickerInput(
              inputId = "summarise_omop_snapshot_variable_name",
              label = "Variable name",
              choices = filterValues$summarise_omop_snapshot_variable_name,
              selected = filterValues$summarise_omop_snapshot_variable_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          ),
          bslib::accordion_panel(
            title = "Estimates",
            shinyWidgets::pickerInput(
              inputId = "summarise_omop_snapshot_estimate_name",
              label = "Estimate name",
              choices = filterValues$summarise_omop_snapshot_estimate_name,
              selected = filterValues$summarise_omop_snapshot_estimate_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          )
        )
      ),
      bslib::navset_card_tab(
        bslib::nav_panel(
          title = "Tidy",
          bslib::card(
            full_screen = TRUE,
            bslib::card_header(
              bslib::popover(
                shiny::icon("download"),
                shiny::downloadButton(outputId = "summarise_omop_snapshot_tidy_download", label = "Download csv")
              ),
              class = "text-end"
            ),
            bslib::layout_sidebar(
              sidebar = bslib::sidebar(
                shinyWidgets::pickerInput(
                  inputId = "summarise_omop_snapshot_tidy_columns",
                  label = "Columns",
                  choices = filterValues$summarise_omop_snapshot_tidy_columns,
                  selected = filterValues$summarise_omop_snapshot_tidy_columns,
                  multiple = TRUE,
                  options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                ),
                shiny::radioButtons(
                  inputId = "summarise_omop_snapshot_tidy_pivot",
                  label = "Pivot estimates/variables",
                  choices = c("none", "estimates", "estimates and variables"),
                  selected = "none"
                ),
                position = "right"
              ),
              DT::dataTableOutput("summarise_omop_snapshot_tidy")
            )
          )
        ),
        bslib::nav_panel(
          title = "Snapshot table",
          bslib::card(
            full_screen = TRUE,
            bslib::card_header(
              bslib::popover(
                shiny::icon("download"),
                shinyWidgets::pickerInput(
                  inputId = "summarise_omop_snapshot_gt_17_download_type",
                  label = "File type",
                  selected = "docx",
                  choices = c("docx", "png", "pdf", "html"),
                  multiple = FALSE
                ),
                shiny::downloadButton(outputId = "summarise_omop_snapshot_gt_17_download", label = "Download")
              ),
              class = "text-end"
            ),
            gt::gt_output("summarise_omop_snapshot_gt_17")
          )
        )
      )
    )
  ),
  bslib::nav_panel(
    title = "Cohort count",
    icon = shiny::icon("users"),
    bslib::layout_sidebar(
      sidebar = bslib::sidebar(
        bslib::accordion(
          bslib::accordion_panel(
            title = "Settings",
            shinyWidgets::pickerInput(
              inputId = "summarise_cohort_count_settings_table_name",
              label = "Table name",
              choices = filterValues$summarise_cohort_count_settings_table_name,
              selected = filterValues$summarise_cohort_count_settings_table_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          ),
          bslib::accordion_panel(
            title = "Grouping",
            shinyWidgets::pickerInput(
              inputId = "summarise_cohort_count_grouping_cdm_name",
              label = "Cdm name",
              choices = filterValues$summarise_cohort_count_grouping_cdm_name,
              selected = filterValues$summarise_cohort_count_grouping_cdm_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_cohort_count_grouping_cohort_name",
              label = "Cohort name",
              choices = filterValues$summarise_cohort_count_grouping_cohort_name,
              selected = filterValues$summarise_cohort_count_grouping_cohort_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          ),
          bslib::accordion_panel(
            title = "Variables",
            shinyWidgets::pickerInput(
              inputId = "summarise_cohort_count_variable_name",
              label = "Variable name",
              choices = filterValues$summarise_cohort_count_variable_name,
              selected = filterValues$summarise_cohort_count_variable_name[1],
              multiple = FALSE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          ),
          bslib::accordion_panel(
            title = "Estimates",
            shinyWidgets::pickerInput(
              inputId = "summarise_cohort_count_estimate_name",
              label = "Estimate name",
              choices = filterValues$summarise_cohort_count_estimate_name,
              selected = filterValues$summarise_cohort_count_estimate_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          )
        )
      ),
      bslib::navset_card_tab(
        bslib::nav_panel(
          title = "Tidy",
          bslib::card(
            full_screen = TRUE,
            bslib::card_header(
              bslib::popover(
                shiny::icon("download"),
                shiny::downloadButton(outputId = "summarise_cohort_count_tidy_download", label = "Download csv")
              ),
              class = "text-end"
            ),
            bslib::layout_sidebar(
              sidebar = bslib::sidebar(
                shinyWidgets::pickerInput(
                  inputId = "summarise_cohort_count_tidy_columns",
                  label = "Columns",
                  choices = filterValues$summarise_cohort_count_tidy_columns,
                  selected = filterValues$summarise_cohort_count_tidy_columns,
                  multiple = TRUE,
                  options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                ),
                shiny::radioButtons(
                  inputId = "summarise_cohort_count_tidy_pivot",
                  label = "Pivot estimates/variables",
                  choices = c("none", "estimates", "estimates and variables"),
                  selected = "none"
                ),
                position = "right"
              ),
              DT::dataTableOutput("summarise_cohort_count_tidy")
            )
          )
        ),
        bslib::nav_panel(
          title = "Table cohort count",
          bslib::card(
            full_screen = TRUE,
            bslib::card_header(
              bslib::popover(
                shiny::icon("download"),
                shinyWidgets::pickerInput(
                  inputId = "summarise_cohort_count_gt_9_download_type",
                  label = "File type",
                  selected = "docx",
                  choices = c("docx", "png", "pdf", "html"),
                  multiple = FALSE
                ),
                shiny::downloadButton(outputId = "summarise_cohort_count_gt_9_download", label = "Download")
              ),
              class = "text-end"
            ),
            bslib::layout_sidebar(
              sidebar = bslib::sidebar(
                sortable::bucket_list(
                  header = NULL,
                  sortable::add_rank_list(
                    text = "none",
                    labels = c("cdm_name", "variable_name", "variable_level", "estimate_name"),
                    input_id = "summarise_cohort_count_gt_9_none"
                  ),
                  sortable::add_rank_list(
                    text = "header",
                    labels = "cohort_name",
                    input_id = "summarise_cohort_count_gt_9_header"
                  ),
                  sortable::add_rank_list(
                    text = "groupColumn",
                    labels = character(),
                    input_id = "summarise_cohort_count_gt_9_groupColumn"
                  ),
                  sortable::add_rank_list(
                    text = "hide",
                    labels = character(),
                    input_id = "summarise_cohort_count_gt_9_hide"
                  )
                ),
                position = "right"
              ),
              gt::gt_output("summarise_cohort_count_gt_9")
            )
          )
        ),
        bslib::nav_panel(
          title = "Plot cohort count",
          bslib::card(
            full_screen = TRUE,
            bslib::card_header(
              bslib::popover(
                shiny::icon("download"),
                shiny::numericInput(
                  inputId = "summarise_cohort_count_ggplot2_10_download_width",
                  label = "Width",
                  value = 15
                ),
                shiny::numericInput(
                  inputId = "summarise_cohort_count_ggplot2_10_download_height",
                  label = "Height",
                  value = 10
                ),
                shinyWidgets::pickerInput(
                  inputId = "summarise_cohort_count_ggplot2_10_download_units",
                  label = "Units",
                  selected = "cm",
                  choices = c("px", "cm", "inch"),
                  multiple = FALSE
                ),
                shiny::numericInput(
                  inputId = "summarise_cohort_count_ggplot2_10_download_dpi",
                  label = "dpi",
                  value = 300
                ),
                shiny::downloadButton(outputId = "summarise_cohort_count_ggplot2_10_download", label = "Download")
              ),
              class = "text-end"
            ),
            bslib::layout_sidebar(
              sidebar = bslib::sidebar(
                shinyWidgets::pickerInput(
                  inputId = "summarise_cohort_count_ggplot2_10_facet",
                  label = "facet",
                  selected = "cdm_name",
                  multiple = TRUE,
                  choices = c("cdm_name", "cohort_name", "variable_name", "variable_level", "estimate_name"),
                  options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                ),
                shinyWidgets::pickerInput(
                  inputId = "summarise_cohort_count_ggplot2_10_colour",
                  label = "colour",
                  selected = NULL,
                  multiple = TRUE,
                  choices = c("cdm_name", "cohort_name", "variable_name", "variable_level", "estimate_name"),
                  options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                ),
                position = "right"
              ),
              shiny::plotOutput("summarise_cohort_count_ggplot2_10")
            )
          )
        )
      )
    )
  ),
  bslib::nav_panel(
    title = "Cohort Attrition",
    icon = shiny::icon("layer-group"),
    bslib::layout_sidebar(
      sidebar = bslib::sidebar(
        bslib::accordion(
          bslib::accordion_panel(
            title = "Settings",
            shinyWidgets::pickerInput(
              inputId = "summarise_cohort_attrition_settings_table_name",
              label = "Table name",
              choices = filterValues$summarise_cohort_attrition_settings_table_name,
              selected = filterValues$summarise_cohort_attrition_settings_table_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
            # shinyWidgets::pickerInput(
            #   inputId = "summarise_cohort_attrition_settings_age_group",
            #   label = "Age group",
            #   choices = filterValues$summarise_cohort_attrition_settings_age_group,
            #   selected = filterValues$summarise_cohort_attrition_settings_age_group,
            #   multiple = TRUE,
            #   options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            # ),
            # shinyWidgets::pickerInput(
            #   inputId = "summarise_cohort_attrition_settings_cohort_definition_id",
            #   label = "Cohort definition id",
            #   choices = filterValues$summarise_cohort_attrition_settings_cohort_definition_id,
            #   selected = filterValues$summarise_cohort_attrition_settings_cohort_definition_id,
            #   multiple = TRUE,
            #   options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            # ),
            # shinyWidgets::pickerInput(
            #   inputId = "summarise_cohort_attrition_settings_days_prior_observation",
            #   label = "Days prior observation",
            #   choices = filterValues$summarise_cohort_attrition_settings_days_prior_observation,
            #   selected = filterValues$summarise_cohort_attrition_settings_days_prior_observation,
            #   multiple = TRUE,
            #   options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            # ),
            # shinyWidgets::pickerInput(
            #   inputId = "summarise_cohort_attrition_settings_end_date",
            #   label = "End date",
            #   choices = filterValues$summarise_cohort_attrition_settings_end_date,
            #   selected = filterValues$summarise_cohort_attrition_settings_end_date,
            #   multiple = TRUE,
            #   options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            # ),
            # shinyWidgets::pickerInput(
            #   inputId = "summarise_cohort_attrition_settings_gap_era",
            #   label = "Gap era",
            #   choices = filterValues$summarise_cohort_attrition_settings_gap_era,
            #   selected = filterValues$summarise_cohort_attrition_settings_gap_era,
            #   multiple = TRUE,
            #   options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            # ),
            # shinyWidgets::pickerInput(
            #   inputId = "summarise_cohort_attrition_settings_limit",
            #   label = "Limit",
            #   choices = filterValues$summarise_cohort_attrition_settings_limit,
            #   selected = filterValues$summarise_cohort_attrition_settings_limit,
            #   multiple = TRUE,
            #   options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            # ),
            # shinyWidgets::pickerInput(
            #   inputId = "summarise_cohort_attrition_settings_prior_drug_observation",
            #   label = "Prior drug observation",
            #   choices = filterValues$summarise_cohort_attrition_settings_prior_drug_observation,
            #   selected = filterValues$summarise_cohort_attrition_settings_prior_drug_observation,
            #   multiple = TRUE,
            #   options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            # ),
            # shinyWidgets::pickerInput(
            #   inputId = "summarise_cohort_attrition_settings_sex",
            #   label = "Sex",
            #   choices = filterValues$summarise_cohort_attrition_settings_sex,
            #   selected = filterValues$summarise_cohort_attrition_settings_sex,
            #   multiple = TRUE,
            #   options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            # )

          ),
          bslib::accordion_panel(
            title = "Grouping",
            shinyWidgets::pickerInput(
              inputId = "summarise_cohort_attrition_grouping_cdm_name",
              label = "Cdm name",
              choices = filterValues$summarise_cohort_attrition_grouping_cdm_name,
              selected = filterValues$summarise_cohort_attrition_grouping_cdm_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_cohort_attrition_grouping_cohort_name",
              label = "Cohort name",
              choices = filterValues$summarise_cohort_attrition_grouping_cohort_name,
              selected = filterValues$summarise_cohort_attrition_grouping_cohort_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_cohort_attrition_grouping_reason",
              label = "Reason",
              choices = filterValues$summarise_cohort_attrition_grouping_reason,
              selected = filterValues$summarise_cohort_attrition_grouping_reason,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_cohort_attrition_grouping_reason_id",
              label = "Reason id",
              choices = filterValues$summarise_cohort_attrition_grouping_reason_id,
              selected = filterValues$summarise_cohort_attrition_grouping_reason_id,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          ),
          bslib::accordion_panel(
            title = "Variables",
            shinyWidgets::pickerInput(
              inputId = "summarise_cohort_attrition_variable_name",
              label = "Variable name",
              choices = filterValues$summarise_cohort_attrition_variable_name,
              selected = filterValues$summarise_cohort_attrition_variable_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          ),
          bslib::accordion_panel(
            title = "Estimates",
            shinyWidgets::pickerInput(
              inputId = "summarise_cohort_attrition_estimate_name",
              label = "Estimate name",
              choices = filterValues$summarise_cohort_attrition_estimate_name,
              selected = filterValues$summarise_cohort_attrition_estimate_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          )
        )
      ),
      bslib::navset_card_tab(
        bslib::nav_panel(
          title = "Tidy",
          bslib::card(
            full_screen = TRUE,
            bslib::card_header(
              bslib::popover(
                shiny::icon("download"),
                shiny::downloadButton(outputId = "summarise_cohort_attrition_tidy_download", label = "Download csv")
              ),
              class = "text-end"
            ),
            bslib::layout_sidebar(
              sidebar = bslib::sidebar(
                shinyWidgets::pickerInput(
                  inputId = "summarise_cohort_attrition_tidy_columns",
                  label = "Columns",
                  choices = filterValues$summarise_cohort_attrition_tidy_columns,
                  selected = filterValues$summarise_cohort_attrition_tidy_columns,
                  multiple = TRUE,
                  options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                ),
                shiny::radioButtons(
                  inputId = "summarise_cohort_attrition_tidy_pivot",
                  label = "Pivot estimates/variables",
                  choices = c("none", "estimates", "estimates and variables"),
                  selected = "none"
                ),
                position = "right"
              ),
              DT::dataTableOutput("summarise_cohort_attrition_tidy")
            )
          )
        ),
        bslib::nav_panel(
          title = "Table cohort attrition",
          bslib::card(
            full_screen = TRUE,
            bslib::card_header(
              bslib::popover(
                shiny::icon("download"),
                shinyWidgets::pickerInput(
                  inputId = "summarise_cohort_attrition_gt_3_download_type",
                  label = "File type",
                  selected = "docx",
                  choices = c("docx", "png", "pdf", "html"),
                  multiple = FALSE
                ),
                shiny::downloadButton(outputId = "summarise_cohort_attrition_gt_3_download", label = "Download")
              ),
              class = "text-end"
            ),
            bslib::layout_sidebar(
              sidebar = bslib::sidebar(
                sortable::bucket_list(
                  header = NULL,
                  sortable::add_rank_list(
                    text = "none",
                    labels = c("reason", "reason_id", "variable_level", "estimate_name"),
                    input_id = "summarise_cohort_attrition_gt_3_none"
                  ),
                  sortable::add_rank_list(
                    text = "header",
                    labels = "variable_name",
                    input_id = "summarise_cohort_attrition_gt_3_header"
                  ),
                  sortable::add_rank_list(
                    text = "groupColumn",
                    labels = c("cdm_name", "cohort_name"),
                    input_id = "summarise_cohort_attrition_gt_3_groupColumn"
                  ),
                  sortable::add_rank_list(
                    text = "hide",
                    labels = character(),
                    input_id = "summarise_cohort_attrition_gt_3_hide"
                  )
                ),
                position = "right"
              ),
              gt::gt_output("summarise_cohort_attrition_gt_3")
            )
          )
        ),
        bslib::nav_panel(
          title = "Diagram",
          bslib::card(
            full_screen = TRUE,
            bslib::card_header(
              bslib::popover(
                shiny::icon("download"),
                shiny::numericInput(
                  inputId = "summarise_cohort_attrition_grViz_4_download_width",
                  label = "Width (px)",
                  value = 15
                ),
                shiny::numericInput(
                  inputId = "summarise_cohort_attrition_grViz_4_download_height",
                  label = "Height (px)",
                  value = 10
                ),
                shiny::downloadButton(outputId = "summarise_cohort_attrition_grViz_4_download", label = "Download")
              ),
              class = "text-end"
            ),
            DiagrammeR::grVizOutput("summarise_cohort_attrition_grViz_4")
          )
        )
      )
    )
  ),
  bslib::nav_panel(
    title = "Prevalence",
    icon = shiny::icon("chart-line"),
    bslib::layout_sidebar(
      sidebar = bslib::sidebar(
        bslib::accordion(
          bslib::accordion_panel(
            title = "Settings",
            shinyWidgets::pickerInput(
              inputId = "prevalence_settings_analysis_complete_database_intervals",
              label = "Analysis complete database intervals",
              choices = filterValues$prevalence_settings_analysis_complete_database_intervals,
              selected = filterValues$prevalence_settings_analysis_complete_database_intervals,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "prevalence_settings_analysis_full_contribution",
              label = "Analysis full contribution",
              choices = filterValues$prevalence_settings_analysis_full_contribution,
              selected = filterValues$prevalence_settings_analysis_full_contribution,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "prevalence_settings_analysis_type",
              label = "Analysis type",
              choices = filterValues$prevalence_settings_analysis_type,
              selected = filterValues$prevalence_settings_analysis_type,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "prevalence_settings_denominator_age_group",
              label = "Denominator age group",
              choices = filterValues$prevalence_settings_denominator_age_group,
              selected = filterValues$prevalence_settings_denominator_age_group[1],
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "prevalence_settings_denominator_days_prior_observation",
              label = "Denominator days prior observation",
              choices = filterValues$prevalence_settings_denominator_days_prior_observation,
              selected = filterValues$prevalence_settings_denominator_days_prior_observation,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "prevalence_settings_denominator_end_date",
              label = "Denominator end date",
              choices = filterValues$prevalence_settings_denominator_end_date,
              selected = filterValues$prevalence_settings_denominator_end_date,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "prevalence_settings_denominator_sex",
              label = "Denominator sex",
              choices = filterValues$prevalence_settings_denominator_sex,
              selected = filterValues$prevalence_settings_denominator_sex,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "prevalence_settings_denominator_start_date",
              label = "Denominator start date",
              choices = filterValues$prevalence_settings_denominator_start_date,
              selected = filterValues$prevalence_settings_denominator_start_date,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "prevalence_settings_denominator_target_cohort_name",
              label = "Denominator target cohort name",
              choices = filterValues$prevalence_settings_denominator_target_cohort_name,
              selected = filterValues$prevalence_settings_denominator_target_cohort_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "prevalence_settings_denominator_time_at_risk",
              label = "Denominator time at risk",
              choices = filterValues$prevalence_settings_denominator_time_at_risk,
              selected = filterValues$prevalence_settings_denominator_time_at_risk,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          ),
          bslib::accordion_panel(
            title = "Grouping",
            shinyWidgets::pickerInput(
              inputId = "prevalence_grouping_cdm_name",
              label = "Cdm name",
              choices = filterValues$prevalence_grouping_cdm_name,
              selected = filterValues$prevalence_grouping_cdm_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "prevalence_grouping_denominator_cohort_name",
              label = "Denominator cohort name",
              choices = filterValues$prevalence_grouping_denominator_cohort_name,
              selected = filterValues$prevalence_grouping_denominator_cohort_name[1],
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "prevalence_grouping_outcome_cohort_name",
              label = "Outcome cohort name",
              choices = filterValues$prevalence_grouping_outcome_cohort_name,
              selected = filterValues$prevalence_grouping_outcome_cohort_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "prevalence_grouping_prevalence_start_date",
              label = "Prevalence start date",
              choices = filterValues$prevalence_grouping_prevalence_start_date,
              selected = filterValues$prevalence_grouping_prevalence_start_date,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "prevalence_grouping_prevalence_end_date",
              label = "Prevalence end date",
              choices = filterValues$prevalence_grouping_prevalence_end_date,
              selected = filterValues$prevalence_grouping_prevalence_end_date,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "prevalence_grouping_analysis_interval",
              label = "Analysis interval",
              choices = filterValues$prevalence_grouping_analysis_interval,
              selected = filterValues$prevalence_grouping_analysis_interval,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          ),
          bslib::accordion_panel(
            title = "Variables",
            shinyWidgets::pickerInput(
              inputId = "prevalence_variable_name",
              label = "Variable name",
              choices = filterValues$prevalence_variable_name,
              selected = filterValues$prevalence_variable_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          ),
          bslib::accordion_panel(
            title = "Estimates",
            shinyWidgets::pickerInput(
              inputId = "prevalence_estimate_name",
              label = "Estimate name",
              choices = filterValues$prevalence_estimate_name,
              selected = filterValues$prevalence_estimate_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          )
        )
      ),
      bslib::navset_card_tab(
        bslib::nav_panel(
          title = "Tidy",
          bslib::card(
            full_screen = TRUE,
            bslib::card_header(
              bslib::popover(
                shiny::icon("download"),
                shiny::downloadButton(outputId = "prevalence_tidy_download", label = "Download csv")
              ),
              class = "text-end"
            ),
            bslib::layout_sidebar(
              sidebar = bslib::sidebar(
                shinyWidgets::pickerInput(
                  inputId = "prevalence_tidy_columns",
                  label = "Columns",
                  choices = filterValues$prevalence_tidy_columns,
                  selected = filterValues$prevalence_tidy_columns,
                  multiple = TRUE,
                  options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                ),
                shiny::radioButtons(
                  inputId = "prevalence_tidy_pivot",
                  label = "Pivot estimates/variables",
                  choices = c("none", "estimates", "estimates and variables"),
                  selected = "none"
                ),
                position = "right"
              ),
              DT::dataTableOutput("prevalence_tidy")
            )
          )
        ),
        bslib::nav_panel(
          title = "Table prevalence",
          bslib::card(
            full_screen = TRUE,
            bslib::card_header(
              bslib::popover(
                shiny::icon("download"),
                shinyWidgets::pickerInput(
                  inputId = "prevalence_gt_20_download_type",
                  label = "File type",
                  selected = "docx",
                  choices = c("docx", "png", "pdf", "html"),
                  multiple = FALSE
                ),
                shiny::downloadButton(outputId = "prevalence_gt_20_download", label = "Download")
              ),
              class = "text-end"
            ),
            bslib::layout_sidebar(
              sidebar = bslib::sidebar(
                sortable::bucket_list(
                  header = NULL,
                  sortable::add_rank_list(
                    text = "none",
                    labels = c("prevalence_start_date", "prevalence_end_date", "analysis_complete_database_intervals", "analysis_full_contribution", "analysis_type", "denominator_age_group", "denominator_days_prior_observation", "denominator_end_date", "denominator_sex", "denominator_start_date", "denominator_target_cohort_name", "denominator_time_at_risk", "variable_name", "variable_level"),
                    input_id = "prevalence_gt_20_none"
                  ),
                  sortable::add_rank_list(
                    text = "header",
                    labels = "estimate_name",
                    input_id = "prevalence_gt_20_header"
                  ),
                  sortable::add_rank_list(
                    text = "groupColumn",
                    labels = c("cdm_name", "outcome_cohort_name"),
                    input_id = "prevalence_gt_20_groupColumn"
                  ),
                  sortable::add_rank_list(
                    text = "hide",
                    labels = c("denominator_cohort_name", "analysis_interval"),
                    input_id = "prevalence_gt_20_hide"
                  )
                ),
                position = "right"
              ),
              gt::gt_output("prevalence_gt_20")
            )
          )
        ),
        bslib::nav_panel(
          title = "Plot prevalence",
          bslib::card(
            full_screen = TRUE,
            bslib::card_header(
              bslib::popover(
                shiny::icon("download"),
                shiny::numericInput(
                  inputId = "prevalence_ggplot2_21_download_width",
                  label = "Width",
                  value = 15
                ),
                shiny::numericInput(
                  inputId = "prevalence_ggplot2_21_download_height",
                  label = "Height",
                  value = 10
                ),
                shinyWidgets::pickerInput(
                  inputId = "prevalence_ggplot2_21_download_units",
                  label = "Units",
                  selected = "cm",
                  choices = c("px", "cm", "inch"),
                  multiple = FALSE
                ),
                shiny::numericInput(
                  inputId = "prevalence_ggplot2_21_download_dpi",
                  label = "dpi",
                  value = 300
                ),
                shiny::downloadButton(outputId = "prevalence_ggplot2_21_download", label = "Download")
              ),
              class = "text-end"
            ),
            bslib::layout_sidebar(
              sidebar = bslib::sidebar(
                shinyWidgets::pickerInput(
                  inputId = "prevalence_ggplot2_21_x",
                  label = "x",
                  selected = "prevalence_start_date",
                  multiple = FALSE,
                  choices = c("cdm_name", "denominator_cohort_name", "outcome_cohort_name", "prevalence_start_date", "prevalence_end_date", "analysis_interval", "analysis_complete_database_intervals", "analysis_full_contribution", "analysis_type", "denominator_age_group", "denominator_days_prior_observation", "denominator_end_date", "denominator_sex", "denominator_start_date", "denominator_target_cohort_name", "denominator_time_at_risk", "variable_name", "variable_level", "estimate_name"),
                  options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                ),
                shiny::checkboxInput(
                  inputId = "prevalence_ggplot2_21_ribbon",
                  label = "ribbon",
                  value = c(FALSE)
                ),
                shinyWidgets::pickerInput(
                  inputId = "prevalence_ggplot2_21_facet",
                  label = "facet",
                  selected = NULL,
                  multiple = TRUE,
                  choices = c("cdm_name", "denominator_cohort_name", "outcome_cohort_name", "prevalence_start_date", "prevalence_end_date", "analysis_interval", "analysis_complete_database_intervals", "analysis_full_contribution", "analysis_type", "denominator_age_group", "denominator_days_prior_observation", "denominator_end_date", "denominator_sex", "denominator_start_date", "denominator_target_cohort_name", "denominator_time_at_risk", "variable_name", "variable_level", "estimate_name"),
                  options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                ),
                shinyWidgets::pickerInput(
                  inputId = "prevalence_ggplot2_21_colour",
                  label = "colour",
                  selected = NULL,
                  multiple = TRUE,
                  choices = c("cdm_name", "denominator_cohort_name", "outcome_cohort_name", "prevalence_start_date", "prevalence_end_date", "analysis_interval", "analysis_complete_database_intervals", "analysis_full_contribution", "analysis_type", "denominator_age_group", "denominator_days_prior_observation", "denominator_end_date", "denominator_sex", "denominator_start_date", "denominator_target_cohort_name", "denominator_time_at_risk", "variable_name", "variable_level", "estimate_name"),
                  options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                ),
                position = "right"
              ),
              shiny::plotOutput("prevalence_ggplot2_21")
            )
          )
        )
      )
    )
  ),
  bslib::nav_panel(
    title = "Prevalence attrition",
    icon = shiny::icon("layer-group"),
    bslib::layout_sidebar(
      sidebar = bslib::sidebar(
        bslib::accordion(
          bslib::accordion_panel(
            title = "Settings",
            shinyWidgets::pickerInput(
              inputId = "prevalence_attrition_settings_analysis_complete_database_intervals",
              label = "Analysis complete database intervals",
              choices = filterValues$prevalence_attrition_settings_analysis_complete_database_intervals,
              selected = filterValues$prevalence_attrition_settings_analysis_complete_database_intervals,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "prevalence_attrition_settings_analysis_full_contribution",
              label = "Analysis full contribution",
              choices = filterValues$prevalence_attrition_settings_analysis_full_contribution,
              selected = filterValues$prevalence_attrition_settings_analysis_full_contribution,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "prevalence_attrition_settings_analysis_type",
              label = "Analysis type",
              choices = filterValues$prevalence_attrition_settings_analysis_type,
              selected = filterValues$prevalence_attrition_settings_analysis_type,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "prevalence_attrition_settings_denominator_age_group",
              label = "Denominator age group",
              choices = filterValues$prevalence_attrition_settings_denominator_age_group,
              selected = filterValues$prevalence_attrition_settings_denominator_age_group,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "prevalence_attrition_settings_denominator_days_prior_observation",
              label = "Denominator days prior observation",
              choices = filterValues$prevalence_attrition_settings_denominator_days_prior_observation,
              selected = filterValues$prevalence_attrition_settings_denominator_days_prior_observation,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "prevalence_attrition_settings_denominator_end_date",
              label = "Denominator end date",
              choices = filterValues$prevalence_attrition_settings_denominator_end_date,
              selected = filterValues$prevalence_attrition_settings_denominator_end_date,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "prevalence_attrition_settings_denominator_sex",
              label = "Denominator sex",
              choices = filterValues$prevalence_attrition_settings_denominator_sex,
              selected = filterValues$prevalence_attrition_settings_denominator_sex,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "prevalence_attrition_settings_denominator_start_date",
              label = "Denominator start date",
              choices = filterValues$prevalence_attrition_settings_denominator_start_date,
              selected = filterValues$prevalence_attrition_settings_denominator_start_date,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "prevalence_attrition_settings_denominator_target_cohort_name",
              label = "Denominator target cohort name",
              choices = filterValues$prevalence_attrition_settings_denominator_target_cohort_name,
              selected = filterValues$prevalence_attrition_settings_denominator_target_cohort_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "prevalence_attrition_settings_denominator_time_at_risk",
              label = "Denominator time at risk",
              choices = filterValues$prevalence_attrition_settings_denominator_time_at_risk,
              selected = filterValues$prevalence_attrition_settings_denominator_time_at_risk,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          ),
          bslib::accordion_panel(
            title = "Grouping",
            shinyWidgets::pickerInput(
              inputId = "prevalence_attrition_grouping_cdm_name",
              label = "Cdm name",
              choices = filterValues$prevalence_attrition_grouping_cdm_name,
              selected = filterValues$prevalence_attrition_grouping_cdm_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "prevalence_attrition_grouping_denominator_cohort_name",
              label = "Denominator cohort name",
              choices = filterValues$prevalence_attrition_grouping_denominator_cohort_name,
              selected = filterValues$prevalence_attrition_grouping_denominator_cohort_name[1],
              multiple = FALSE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "prevalence_attrition_grouping_outcome_cohort_name",
              label = "Outcome cohort name",
              choices = filterValues$prevalence_attrition_grouping_outcome_cohort_name,
              selected = filterValues$prevalence_attrition_grouping_outcome_cohort_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "prevalence_attrition_grouping_reason",
              label = "Reason",
              choices = filterValues$prevalence_attrition_grouping_reason,
              selected = filterValues$prevalence_attrition_grouping_reason,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "prevalence_attrition_grouping_reason_id",
              label = "Reason id",
              choices = filterValues$prevalence_attrition_grouping_reason_id,
              selected = filterValues$prevalence_attrition_grouping_reason_id,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          ),
          bslib::accordion_panel(
            title = "Variables",
            shinyWidgets::pickerInput(
              inputId = "prevalence_attrition_variable_name",
              label = "Variable name",
              choices = filterValues$prevalence_attrition_variable_name,
              selected = filterValues$prevalence_attrition_variable_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          ),
          bslib::accordion_panel(
            title = "Estimates",
            shinyWidgets::pickerInput(
              inputId = "prevalence_attrition_estimate_name",
              label = "Estimate name",
              choices = filterValues$prevalence_attrition_estimate_name,
              selected = filterValues$prevalence_attrition_estimate_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          )
        )
      ),
      bslib::navset_card_tab(
        bslib::nav_panel(
          title = "Tidy",
          bslib::card(
            full_screen = TRUE,
            bslib::card_header(
              bslib::popover(
                shiny::icon("download"),
                shiny::downloadButton(outputId = "prevalence_attrition_tidy_download", label = "Download csv")
              ),
              class = "text-end"
            ),
            bslib::layout_sidebar(
              sidebar = bslib::sidebar(
                shinyWidgets::pickerInput(
                  inputId = "prevalence_attrition_tidy_columns",
                  label = "Columns",
                  choices = filterValues$prevalence_attrition_tidy_columns,
                  selected = filterValues$prevalence_attrition_tidy_columns,
                  multiple = TRUE,
                  options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                ),
                shiny::radioButtons(
                  inputId = "prevalence_attrition_tidy_pivot",
                  label = "Pivot estimates/variables",
                  choices = c("none", "estimates", "estimates and variables"),
                  selected = "none"
                ),
                position = "right"
              ),
              DT::dataTableOutput("prevalence_attrition_tidy")
            )
          )
        ),
        bslib::nav_panel(
          title = "Table prevalence attrition",
          bslib::card(
            full_screen = TRUE,
            bslib::card_header(
              bslib::popover(
                shiny::icon("download"),
                shinyWidgets::pickerInput(
                  inputId = "prevalence_attrition_gt_23_download_type",
                  label = "File type",
                  selected = "docx",
                  choices = c("docx", "png", "pdf", "html"),
                  multiple = FALSE
                ),
                shiny::downloadButton(outputId = "prevalence_attrition_gt_23_download", label = "Download")
              ),
              class = "text-end"
            ),
            bslib::layout_sidebar(
              sidebar = bslib::sidebar(
                sortable::bucket_list(
                  header = NULL,
                  sortable::add_rank_list(
                    text = "none",
                    labels = c("reason", "analysis_complete_database_intervals", "analysis_full_contribution", "analysis_type", "denominator_age_group", "denominator_days_prior_observation", "denominator_end_date", "denominator_sex", "denominator_start_date", "denominator_target_cohort_name", "denominator_time_at_risk"),
                    input_id = "prevalence_attrition_gt_23_none"
                  ),
                  sortable::add_rank_list(
                    text = "header",
                    labels = "variable_name",
                    input_id = "prevalence_attrition_gt_23_header"
                  ),
                  sortable::add_rank_list(
                    text = "groupColumn",
                    labels = c("cdm_name", "outcome_cohort_name"),
                    input_id = "prevalence_attrition_gt_23_groupColumn"
                  ),
                  sortable::add_rank_list(
                    text = "hide",
                    labels = c("denominator_cohort_name", "estimate_name", "reason_id", "variable_level"),
                    input_id = "prevalence_attrition_gt_23_hide"
                  )
                ),
                position = "right"
              ),
              gt::gt_output("prevalence_attrition_gt_23")
            )
          )
        )
      )
    )
  ),
  bslib::nav_panel(
    title = "Incidence",
    icon = shiny::icon("chart-line"),
    bslib::layout_sidebar(
      sidebar = bslib::sidebar(
        bslib::accordion(
          bslib::accordion_panel(
            title = "Settings",
            shinyWidgets::pickerInput(
              inputId = "incidence_settings_analysis_complete_database_intervals",
              label = "Analysis complete database intervals",
              choices = filterValues$incidence_settings_analysis_complete_database_intervals,
              selected = filterValues$incidence_settings_analysis_complete_database_intervals,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "incidence_settings_analysis_outcome_washout",
              label = "Analysis outcome washout",
              choices = filterValues$incidence_settings_analysis_outcome_washout,
              selected = filterValues$incidence_settings_analysis_outcome_washout,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "incidence_settings_analysis_repeated_events",
              label = "Analysis repeated events",
              choices = filterValues$incidence_settings_analysis_repeated_events,
              selected = filterValues$incidence_settings_analysis_repeated_events,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "incidence_settings_denominator_age_group",
              label = "Denominator age group",
              choices = filterValues$incidence_settings_denominator_age_group,
              selected = filterValues$incidence_settings_denominator_age_group,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "incidence_settings_denominator_days_prior_observation",
              label = "Denominator days prior observation",
              choices = filterValues$incidence_settings_denominator_days_prior_observation,
              selected = filterValues$incidence_settings_denominator_days_prior_observation,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "incidence_settings_denominator_end_date",
              label = "Denominator end date",
              choices = filterValues$incidence_settings_denominator_end_date,
              selected = filterValues$incidence_settings_denominator_end_date,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "incidence_settings_denominator_sex",
              label = "Denominator sex",
              choices = filterValues$incidence_settings_denominator_sex,
              selected = filterValues$incidence_settings_denominator_sex,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "incidence_settings_denominator_start_date",
              label = "Denominator start date",
              choices = filterValues$incidence_settings_denominator_start_date,
              selected = filterValues$incidence_settings_denominator_start_date,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "incidence_settings_denominator_target_cohort_name",
              label = "Denominator target cohort name",
              choices = filterValues$incidence_settings_denominator_target_cohort_name,
              selected = filterValues$incidence_settings_denominator_target_cohort_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "incidence_settings_denominator_time_at_risk",
              label = "Denominator time at risk",
              choices = filterValues$incidence_settings_denominator_time_at_risk,
              selected = filterValues$incidence_settings_denominator_time_at_risk,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          ),
          bslib::accordion_panel(
            title = "Grouping",
            shinyWidgets::pickerInput(
              inputId = "incidence_grouping_cdm_name",
              label = "Cdm name",
              choices = filterValues$incidence_grouping_cdm_name,
              selected = filterValues$incidence_grouping_cdm_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "incidence_grouping_denominator_cohort_name",
              label = "Denominator cohort name",
              choices = filterValues$incidence_grouping_denominator_cohort_name,
              selected = filterValues$incidence_grouping_denominator_cohort_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "incidence_grouping_outcome_cohort_name",
              label = "Outcome cohort name",
              choices = filterValues$incidence_grouping_outcome_cohort_name,
              selected = filterValues$incidence_grouping_outcome_cohort_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "incidence_grouping_incidence_start_date",
              label = "Incidence start date",
              choices = filterValues$incidence_grouping_incidence_start_date,
              selected = filterValues$incidence_grouping_incidence_start_date,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "incidence_grouping_incidence_end_date",
              label = "Incidence end date",
              choices = filterValues$incidence_grouping_incidence_end_date,
              selected = filterValues$incidence_grouping_incidence_end_date,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "incidence_grouping_analysis_interval",
              label = "Analysis interval",
              choices = filterValues$incidence_grouping_analysis_interval,
              selected = filterValues$incidence_grouping_analysis_interval,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          ),
          bslib::accordion_panel(
            title = "Variables",
            shinyWidgets::pickerInput(
              inputId = "incidence_variable_name",
              label = "Variable name",
              choices = filterValues$incidence_variable_name,
              selected = filterValues$incidence_variable_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          ),
          bslib::accordion_panel(
            title = "Estimates",
            shinyWidgets::pickerInput(
              inputId = "incidence_estimate_name",
              label = "Estimate name",
              choices = filterValues$incidence_estimate_name,
              selected = filterValues$incidence_estimate_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          )
        )
      ),
      bslib::navset_card_tab(
        bslib::nav_panel(
          title = "Tidy",
          bslib::card(
            full_screen = TRUE,
            bslib::card_header(
              bslib::popover(
                shiny::icon("download"),
                shiny::downloadButton(outputId = "incidence_tidy_download", label = "Download csv")
              ),
              class = "text-end"
            ),
            bslib::layout_sidebar(
              sidebar = bslib::sidebar(
                shinyWidgets::pickerInput(
                  inputId = "incidence_tidy_columns",
                  label = "Columns",
                  choices = filterValues$incidence_tidy_columns,
                  selected = filterValues$incidence_tidy_columns,
                  multiple = TRUE,
                  options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                ),
                shiny::radioButtons(
                  inputId = "incidence_tidy_pivot",
                  label = "Pivot estimates/variables",
                  choices = c("none", "estimates", "estimates and variables"),
                  selected = "none"
                ),
                position = "right"
              ),
              DT::dataTableOutput("incidence_tidy")
            )
          )
        ),
        bslib::nav_panel(
          title = "Table incidence",
          bslib::card(
            full_screen = TRUE,
            bslib::card_header(
              bslib::popover(
                shiny::icon("download"),
                shinyWidgets::pickerInput(
                  inputId = "incidence_gt_18_download_type",
                  label = "File type",
                  selected = "docx",
                  choices = c("docx", "png", "pdf", "html"),
                  multiple = FALSE
                ),
                shiny::downloadButton(outputId = "incidence_gt_18_download", label = "Download")
              ),
              class = "text-end"
            ),
            bslib::layout_sidebar(
              sidebar = bslib::sidebar(
                sortable::bucket_list(
                  header = NULL,
                  sortable::add_rank_list(
                    text = "none",
                    labels = c("incidence_start_date", "incidence_end_date", "analysis_complete_database_intervals", "analysis_outcome_washout", "analysis_repeated_events", "denominator_age_group", "denominator_days_prior_observation", "denominator_end_date", "denominator_sex", "denominator_start_date", "denominator_target_cohort_name", "denominator_time_at_risk", "variable_name", "variable_level"),
                    input_id = "incidence_gt_18_none"
                  ),
                  sortable::add_rank_list(
                    text = "header",
                    labels = "estimate_name",
                    input_id = "incidence_gt_18_header"
                  ),
                  sortable::add_rank_list(
                    text = "groupColumn",
                    labels = c("cdm_name", "outcome_cohort_name"),
                    input_id = "incidence_gt_18_groupColumn"
                  ),
                  sortable::add_rank_list(
                    text = "hide",
                    labels = c("denominator_cohort_name", "analysis_interval"),
                    input_id = "incidence_gt_18_hide"
                  )
                ),
                position = "right"
              ),
              gt::gt_output("incidence_gt_18")
            )
          )
        ),
        bslib::nav_panel(
          title = "Plot incidence",
          bslib::card(
            full_screen = TRUE,
            bslib::card_header(
              bslib::popover(
                shiny::icon("download"),
                shiny::numericInput(
                  inputId = "incidence_ggplot2_19_download_width",
                  label = "Width",
                  value = 15
                ),
                shiny::numericInput(
                  inputId = "incidence_ggplot2_19_download_height",
                  label = "Height",
                  value = 10
                ),
                shinyWidgets::pickerInput(
                  inputId = "incidence_ggplot2_19_download_units",
                  label = "Units",
                  selected = "cm",
                  choices = c("px", "cm", "inch"),
                  multiple = FALSE
                ),
                shiny::numericInput(
                  inputId = "incidence_ggplot2_19_download_dpi",
                  label = "dpi",
                  value = 300
                ),
                shiny::downloadButton(outputId = "incidence_ggplot2_19_download", label = "Download")
              ),
              class = "text-end"
            ),
            bslib::layout_sidebar(
              sidebar = bslib::sidebar(
                shinyWidgets::pickerInput(
                  inputId = "incidence_ggplot2_19_x",
                  label = "x",
                  selected = "incidence_start_date",
                  multiple = FALSE,
                  choices = c("cdm_name", "denominator_cohort_name", "outcome_cohort_name", "incidence_start_date", "incidence_end_date", "analysis_interval", "analysis_complete_database_intervals", "analysis_outcome_washout", "analysis_repeated_events", "denominator_age_group", "denominator_days_prior_observation", "denominator_end_date", "denominator_sex", "denominator_start_date", "denominator_target_cohort_name", "denominator_time_at_risk", "variable_name", "variable_level", "estimate_name"),
                  options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                ),
                shiny::checkboxInput(
                  inputId = "incidence_ggplot2_19_ribbon",
                  label = "ribbon",
                  value = c(FALSE)
                ),
                shinyWidgets::pickerInput(
                  inputId = "incidence_ggplot2_19_facet",
                  label = "facet",
                  selected = NULL,
                  multiple = TRUE,
                  choices = c("cdm_name", "denominator_cohort_name", "outcome_cohort_name", "incidence_start_date", "incidence_end_date", "analysis_interval", "analysis_complete_database_intervals", "analysis_outcome_washout", "analysis_repeated_events", "denominator_age_group", "denominator_days_prior_observation", "denominator_end_date", "denominator_sex", "denominator_start_date", "denominator_target_cohort_name", "denominator_time_at_risk", "variable_name", "variable_level", "estimate_name"),
                  options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                ),
                shinyWidgets::pickerInput(
                  inputId = "incidence_ggplot2_19_colour",
                  label = "colour",
                  selected = NULL,
                  multiple = TRUE,
                  choices = c("cdm_name", "denominator_cohort_name", "outcome_cohort_name", "incidence_start_date", "incidence_end_date", "analysis_interval", "analysis_complete_database_intervals", "analysis_outcome_washout", "analysis_repeated_events", "denominator_age_group", "denominator_days_prior_observation", "denominator_end_date", "denominator_sex", "denominator_start_date", "denominator_target_cohort_name", "denominator_time_at_risk", "variable_name", "variable_level", "estimate_name"),
                  options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                ),
                position = "right"
              ),
              shiny::plotOutput("incidence_ggplot2_19")
            )
          )
        )
      )
    )
  ),
  bslib::nav_panel(
    title = "Incidence attrition",
    icon = shiny::icon("layer-group"),
    bslib::layout_sidebar(
      sidebar = bslib::sidebar(
        bslib::accordion(
          bslib::accordion_panel(
            title = "Settings",
            shinyWidgets::pickerInput(
              inputId = "incidence_attrition_settings_analysis_complete_database_intervals",
              label = "Analysis complete database intervals",
              choices = filterValues$incidence_attrition_settings_analysis_complete_database_intervals,
              selected = filterValues$incidence_attrition_settings_analysis_complete_database_intervals,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "incidence_attrition_settings_analysis_outcome_washout",
              label = "Analysis outcome washout",
              choices = filterValues$incidence_attrition_settings_analysis_outcome_washout,
              selected = filterValues$incidence_attrition_settings_analysis_outcome_washout,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "incidence_attrition_settings_analysis_repeated_events",
              label = "Analysis repeated events",
              choices = filterValues$incidence_attrition_settings_analysis_repeated_events,
              selected = filterValues$incidence_attrition_settings_analysis_repeated_events,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "incidence_attrition_settings_denominator_age_group",
              label = "Denominator age group",
              choices = filterValues$incidence_attrition_settings_denominator_age_group,
              selected = filterValues$incidence_attrition_settings_denominator_age_group,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "incidence_attrition_settings_denominator_days_prior_observation",
              label = "Denominator days prior observation",
              choices = filterValues$incidence_attrition_settings_denominator_days_prior_observation,
              selected = filterValues$incidence_attrition_settings_denominator_days_prior_observation,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "incidence_attrition_settings_denominator_end_date",
              label = "Denominator end date",
              choices = filterValues$incidence_attrition_settings_denominator_end_date,
              selected = filterValues$incidence_attrition_settings_denominator_end_date,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "incidence_attrition_settings_denominator_sex",
              label = "Denominator sex",
              choices = filterValues$incidence_attrition_settings_denominator_sex,
              selected = filterValues$incidence_attrition_settings_denominator_sex,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "incidence_attrition_settings_denominator_start_date",
              label = "Denominator start date",
              choices = filterValues$incidence_attrition_settings_denominator_start_date,
              selected = filterValues$incidence_attrition_settings_denominator_start_date,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "incidence_attrition_settings_denominator_target_cohort_name",
              label = "Denominator target cohort name",
              choices = filterValues$incidence_attrition_settings_denominator_target_cohort_name,
              selected = filterValues$incidence_attrition_settings_denominator_target_cohort_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "incidence_attrition_settings_denominator_time_at_risk",
              label = "Denominator time at risk",
              choices = filterValues$incidence_attrition_settings_denominator_time_at_risk,
              selected = filterValues$incidence_attrition_settings_denominator_time_at_risk,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          ),
          bslib::accordion_panel(
            title = "Grouping",
            shinyWidgets::pickerInput(
              inputId = "incidence_attrition_grouping_cdm_name",
              label = "Cdm name",
              choices = filterValues$incidence_attrition_grouping_cdm_name,
              selected = filterValues$incidence_attrition_grouping_cdm_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "incidence_attrition_grouping_denominator_cohort_name",
              label = "Denominator cohort name",
              choices = filterValues$incidence_attrition_grouping_denominator_cohort_name,
              selected = filterValues$incidence_attrition_grouping_denominator_cohort_name[1],
              multiple = FALSE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "incidence_attrition_grouping_outcome_cohort_name",
              label = "Outcome cohort name",
              choices = filterValues$incidence_attrition_grouping_outcome_cohort_name,
              selected = filterValues$incidence_attrition_grouping_outcome_cohort_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "incidence_attrition_grouping_reason",
              label = "Reason",
              choices = filterValues$incidence_attrition_grouping_reason,
              selected = filterValues$incidence_attrition_grouping_reason,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "incidence_attrition_grouping_reason_id",
              label = "Reason id",
              choices = filterValues$incidence_attrition_grouping_reason_id,
              selected = filterValues$incidence_attrition_grouping_reason_id,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          ),
          bslib::accordion_panel(
            title = "Variables",
            shinyWidgets::pickerInput(
              inputId = "incidence_attrition_variable_name",
              label = "Variable name",
              choices = filterValues$incidence_attrition_variable_name,
              selected = filterValues$incidence_attrition_variable_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          ),
          bslib::accordion_panel(
            title = "Estimates",
            shinyWidgets::pickerInput(
              inputId = "incidence_attrition_estimate_name",
              label = "Estimate name",
              choices = filterValues$incidence_attrition_estimate_name,
              selected = filterValues$incidence_attrition_estimate_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          )
        )
      ),
      bslib::navset_card_tab(
        bslib::nav_panel(
          title = "Tidy",
          bslib::card(
            full_screen = TRUE,
            bslib::card_header(
              bslib::popover(
                shiny::icon("download"),
                shiny::downloadButton(outputId = "incidence_attrition_tidy_download", label = "Download csv")
              ),
              class = "text-end"
            ),
            bslib::layout_sidebar(
              sidebar = bslib::sidebar(
                shinyWidgets::pickerInput(
                  inputId = "incidence_attrition_tidy_columns",
                  label = "Columns",
                  choices = filterValues$incidence_attrition_tidy_columns,
                  selected = filterValues$incidence_attrition_tidy_columns,
                  multiple = TRUE,
                  options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                ),
                shiny::radioButtons(
                  inputId = "incidence_attrition_tidy_pivot",
                  label = "Pivot estimates/variables",
                  choices = c("none", "estimates", "estimates and variables"),
                  selected = "none"
                ),
                position = "right"
              ),
              DT::dataTableOutput("incidence_attrition_tidy")
            )
          )
        ),
        bslib::nav_panel(
          title = "Table incidence attrition",
          bslib::card(
            full_screen = TRUE,
            bslib::card_header(
              bslib::popover(
                shiny::icon("download"),
                shinyWidgets::pickerInput(
                  inputId = "incidence_attrition_gt_22_download_type",
                  label = "File type",
                  selected = "docx",
                  choices = c("docx", "png", "pdf", "html"),
                  multiple = FALSE
                ),
                shiny::downloadButton(outputId = "incidence_attrition_gt_22_download", label = "Download")
              ),
              class = "text-end"
            ),
            bslib::layout_sidebar(
              sidebar = bslib::sidebar(
                sortable::bucket_list(
                  header = NULL,
                  sortable::add_rank_list(
                    text = "none",
                    labels = c("reason", "analysis_complete_database_intervals", "analysis_outcome_washout", "analysis_repeated_events", "denominator_age_group", "denominator_days_prior_observation", "denominator_end_date", "denominator_sex", "denominator_start_date", "denominator_target_cohort_name", "denominator_time_at_risk"),
                    input_id = "incidence_attrition_gt_22_none"
                  ),
                  sortable::add_rank_list(
                    text = "header",
                    labels = "variable_name",
                    input_id = "incidence_attrition_gt_22_header"
                  ),
                  sortable::add_rank_list(
                    text = "groupColumn",
                    labels = c("cdm_name", "outcome_cohort_name"),
                    input_id = "incidence_attrition_gt_22_groupColumn"
                  ),
                  sortable::add_rank_list(
                    text = "hide",
                    labels = c("denominator_cohort_name", "estimate_name", "reason_id", "variable_level"),
                    input_id = "incidence_attrition_gt_22_hide"
                  )
                ),
                position = "right"
              ),
              gt::gt_output("incidence_attrition_gt_22")
            )
          )
        )
      )
    )
  ),
  bslib::nav_panel(
    title = "Cohort characteristics",
    icon = shiny::icon("users-gear"),
    bslib::layout_sidebar(
      sidebar = bslib::sidebar(
        bslib::accordion(
          bslib::accordion_panel(
            title = "Settings",
            shinyWidgets::pickerInput(
              inputId = "summarise_characteristics_settings_table_name",
              label = "Table name",
              choices = filterValues$summarise_characteristics_settings_table_name,
              selected = filterValues$summarise_characteristics_settings_table_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          ),
          bslib::accordion_panel(
            title = "Grouping",
            shinyWidgets::pickerInput(
              inputId = "summarise_characteristics_grouping_cdm_name",
              label = "Cdm name",
              choices = filterValues$summarise_characteristics_grouping_cdm_name,
              selected = filterValues$summarise_characteristics_grouping_cdm_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_characteristics_grouping_cohort_name",
              label = "Cohort name",
              choices = filterValues$summarise_characteristics_grouping_cohort_name,
              selected = filterValues$summarise_characteristics_grouping_cohort_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_characteristics_grouping_age_group",
              label = "Age group",
              choices = filterValues$summarise_characteristics_grouping_age_group,
              selected = filterValues$summarise_characteristics_grouping_age_group[1],
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_characteristics_grouping_sex",
              label = "Sex",
              choices = filterValues$summarise_characteristics_grouping_sex,
              selected = filterValues$summarise_characteristics_grouping_sex,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_characteristics_grouping_table",
              label = "Table",
              choices = filterValues$summarise_characteristics_grouping_table,
              selected = filterValues$summarise_characteristics_grouping_table[1],
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_characteristics_grouping_window",
              label = "Window",
              choices = filterValues$summarise_characteristics_grouping_window,
              selected = filterValues$summarise_characteristics_grouping_window[1],
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_characteristics_grouping_value",
              label = "Value",
              choices = filterValues$summarise_characteristics_grouping_value,
              selected = filterValues$summarise_characteristics_grouping_value[1],
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          ),
          bslib::accordion_panel(
            title = "Variables",
            shinyWidgets::pickerInput(
              inputId = "summarise_characteristics_variable_name",
              label = "Variable name",
              choices = filterValues$summarise_characteristics_variable_name,
              selected = filterValues$summarise_characteristics_variable_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          ),
          bslib::accordion_panel(
            title = "Estimates",
            shinyWidgets::pickerInput(
              inputId = "summarise_characteristics_estimate_name",
              label = "Estimate name",
              choices = filterValues$summarise_characteristics_estimate_name,
              selected = filterValues$summarise_characteristics_estimate_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          )
        )
      ),
      bslib::navset_card_tab(
        bslib::nav_panel(
          title = "Tidy",
          bslib::card(
            full_screen = TRUE,
            bslib::card_header(
              bslib::popover(
                shiny::icon("download"),
                shiny::downloadButton(outputId = "summarise_characteristics_tidy_download", label = "Download csv")
              ),
              class = "text-end"
            ),
            bslib::layout_sidebar(
              sidebar = bslib::sidebar(
                shinyWidgets::pickerInput(
                  inputId = "summarise_characteristics_tidy_columns",
                  label = "Columns",
                  choices = filterValues$summarise_characteristics_tidy_columns,
                  selected = filterValues$summarise_characteristics_tidy_columns,
                  multiple = TRUE,
                  options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                ),
                shiny::radioButtons(
                  inputId = "summarise_characteristics_tidy_pivot",
                  label = "Pivot estimates/variables",
                  choices = c("none", "estimates", "estimates and variables"),
                  selected = "none"
                ),
                position = "right"
              ),
              DT::dataTableOutput("summarise_characteristics_tidy")
            )
          )
        ),
        bslib::nav_panel(
          title = "Table cohort characteristics",
          bslib::card(
            full_screen = TRUE,
            bslib::card_header(
              bslib::popover(
                shiny::icon("download"),
                shinyWidgets::pickerInput(
                  inputId = "summarise_characteristics_gt_7_download_type",
                  label = "File type",
                  selected = "docx",
                  choices = c("docx", "png", "pdf", "html"),
                  multiple = FALSE
                ),
                shiny::downloadButton(outputId = "summarise_characteristics_gt_7_download", label = "Download")
              ),
              class = "text-end"
            ),
            bslib::layout_sidebar(
              sidebar = bslib::sidebar(
                sortable::bucket_list(
                  header = NULL,
                  sortable::add_rank_list(
                    text = "none",
                    labels = c("age_group", "sex", "table", "window", "value", "variable_name", "variable_level", "estimate_name"),
                    input_id = "summarise_characteristics_gt_7_none"
                  ),
                  sortable::add_rank_list(
                    text = "header",
                    labels = c("cdm_name", "cohort_name"),
                    input_id = "summarise_characteristics_gt_7_header"
                  ),
                  sortable::add_rank_list(
                    text = "groupColumn",
                    labels = character(),
                    input_id = "summarise_characteristics_gt_7_groupColumn"
                  ),
                  sortable::add_rank_list(
                    text = "hide",
                    labels = character(),
                    input_id = "summarise_characteristics_gt_7_hide"
                  )
                ),
                position = "right"
              ),
              gt::gt_output("summarise_characteristics_gt_7")
            )
          )
        ),
        bslib::nav_panel(
          title = "Plot characteristics",
          bslib::card(
            full_screen = TRUE,
            bslib::card_header(
              bslib::popover(
                shiny::icon("download"),
                shiny::numericInput(
                  inputId = "summarise_characteristics_ggplot2_8_download_width",
                  label = "Width",
                  value = 15
                ),
                shiny::numericInput(
                  inputId = "summarise_characteristics_ggplot2_8_download_height",
                  label = "Height",
                  value = 10
                ),
                shinyWidgets::pickerInput(
                  inputId = "summarise_characteristics_ggplot2_8_download_units",
                  label = "Units",
                  selected = "cm",
                  choices = c("px", "cm", "inch"),
                  multiple = FALSE
                ),
                shiny::numericInput(
                  inputId = "summarise_characteristics_ggplot2_8_download_dpi",
                  label = "dpi",
                  value = 300
                ),
                shiny::downloadButton(outputId = "summarise_characteristics_ggplot2_8_download", label = "Download")
              ),
              class = "text-end"
            ),
            bslib::layout_sidebar(
              sidebar = bslib::sidebar(
                shinyWidgets::pickerInput(
                  inputId = "summarise_characteristics_ggplot2_8_plotStyle",
                  label = "plotStyle",
                  selected = NULL,
                  multiple = FALSE,
                  choices = c("boxplot", "barplot", "scatterplot"),
                  options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                ),
                shinyWidgets::pickerInput(
                  inputId = "summarise_characteristics_ggplot2_8_facet",
                  label = "facet",
                  selected = NULL,
                  multiple = TRUE,
                  choices = c("cdm_name", "cohort_name", "age_group", "sex", "table", "window", "value", "variable_name", "variable_level", "estimate_name", "table_name"),
                  options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                ),
                shinyWidgets::pickerInput(
                  inputId = "summarise_characteristics_ggplot2_8_colour",
                  label = "colour",
                  selected = NULL,
                  multiple = TRUE,
                  choices = c("cdm_name", "cohort_name", "age_group", "sex", "table", "window", "value", "variable_name", "variable_level", "estimate_name", "table_name"),
                  options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                ),
                position = "right"
              ),
              shiny::plotOutput("summarise_characteristics_ggplot2_8")
            )
          )
        )
      )
    )
  ),
  bslib::nav_panel(
    title = "Indication",
    icon = shiny::icon("disease"),
    bslib::layout_sidebar(
      sidebar = bslib::sidebar(
        bslib::accordion(
          bslib::accordion_panel(
            title = "Settings",
            shinyWidgets::pickerInput(
              inputId = "summarise_indication_settings_cohort_table_name",
              label = "Cohort table name",
              choices = filterValues$summarise_indication_settings_cohort_table_name,
              selected = filterValues$summarise_indication_settings_cohort_table_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_indication_settings_index_date",
              label = "Index date",
              choices = filterValues$summarise_indication_settings_index_date,
              selected = filterValues$summarise_indication_settings_index_date,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_indication_settings_indication_cohort_name",
              label = "Indication cohort name",
              choices = filterValues$summarise_indication_settings_indication_cohort_name,
              selected = filterValues$summarise_indication_settings_indication_cohort_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_indication_settings_mutually_exclusive",
              label = "Mutually exclusive",
              choices = filterValues$summarise_indication_settings_mutually_exclusive,
              selected = filterValues$summarise_indication_settings_mutually_exclusive,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_indication_settings_unknown_indication_table",
              label = "Unknown indication table",
              choices = filterValues$summarise_indication_settings_unknown_indication_table,
              selected = filterValues$summarise_indication_settings_unknown_indication_table,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          ),
          bslib::accordion_panel(
            title = "Grouping",
            shinyWidgets::pickerInput(
              inputId = "summarise_indication_grouping_cdm_name",
              label = "Cdm name",
              choices = filterValues$summarise_indication_grouping_cdm_name,
              selected = filterValues$summarise_indication_grouping_cdm_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_indication_grouping_cohort_name",
              label = "Cohort name",
              choices = filterValues$summarise_indication_grouping_cohort_name,
              selected = filterValues$summarise_indication_grouping_cohort_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_indication_grouping_age_group",
              label = "Age group",
              choices = filterValues$summarise_indication_grouping_age_group,
              selected = filterValues$summarise_indication_grouping_age_group,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_indication_grouping_sex",
              label = "Sex",
              choices = filterValues$summarise_indication_grouping_sex,
              selected = filterValues$summarise_indication_grouping_sex,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_indication_grouping_window_name",
              label = "Window name",
              choices = filterValues$summarise_indication_grouping_window_name,
              selected = filterValues$summarise_indication_grouping_window_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          ),
          bslib::accordion_panel(
            title = "Variables",
            shinyWidgets::pickerInput(
              inputId = "summarise_indication_variable_name",
              label = "Variable name",
              choices = filterValues$summarise_indication_variable_name,
              selected = filterValues$summarise_indication_variable_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          ),
          bslib::accordion_panel(
            title = "Estimates",
            shinyWidgets::pickerInput(
              inputId = "summarise_indication_estimate_name",
              label = "Estimate name",
              choices = filterValues$summarise_indication_estimate_name,
              selected = filterValues$summarise_indication_estimate_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          )
        )
      ),
      bslib::navset_card_tab(
        bslib::nav_panel(
          title = "Tidy",
          bslib::card(
            full_screen = TRUE,
            bslib::card_header(
              bslib::popover(
                shiny::icon("download"),
                shiny::downloadButton(outputId = "summarise_indication_tidy_download", label = "Download csv")
              ),
              class = "text-end"
            ),
            bslib::layout_sidebar(
              sidebar = bslib::sidebar(
                shinyWidgets::pickerInput(
                  inputId = "summarise_indication_tidy_columns",
                  label = "Columns",
                  choices = filterValues$summarise_indication_tidy_columns,
                  selected = filterValues$summarise_indication_tidy_columns,
                  multiple = TRUE,
                  options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                ),
                shiny::radioButtons(
                  inputId = "summarise_indication_tidy_pivot",
                  label = "Pivot estimates/variables",
                  choices = c("none", "estimates", "estimates and variables"),
                  selected = "none"
                ),
                position = "right"
              ),
              DT::dataTableOutput("summarise_indication_tidy")
            )
          )
        ),
        bslib::nav_panel(
          title = "Table indication",
          bslib::card(
            full_screen = TRUE,
            bslib::card_header(
              bslib::popover(
                shiny::icon("download"),
                shinyWidgets::pickerInput(
                  inputId = "summarise_indication_gt_28_download_type",
                  label = "File type",
                  selected = "docx",
                  choices = c("docx", "png", "pdf", "html"),
                  multiple = FALSE
                ),
                shiny::downloadButton(outputId = "summarise_indication_gt_28_download", label = "Download")
              ),
              class = "text-end"
            ),
            gt::gt_output("summarise_indication_gt_28")
          )
        ),
        bslib::nav_panel(
          title = "Plot indication",
          bslib::card(
            full_screen = TRUE,
            bslib::card_header(
              bslib::popover(
                shiny::icon("download"),
                shiny::numericInput(
                  inputId = "summarise_indication_ggplot2_29_download_width",
                  label = "Width",
                  value = 15
                ),
                shiny::numericInput(
                  inputId = "summarise_indication_ggplot2_29_download_height",
                  label = "Height",
                  value = 10
                ),
                shinyWidgets::pickerInput(
                  inputId = "summarise_indication_ggplot2_29_download_units",
                  label = "Units",
                  selected = "cm",
                  choices = c("px", "cm", "inch"),
                  multiple = FALSE
                ),
                shiny::numericInput(
                  inputId = "summarise_indication_ggplot2_29_download_dpi",
                  label = "dpi",
                  value = 300
                ),
                shiny::downloadButton(outputId = "summarise_indication_ggplot2_29_download", label = "Download")
              ),
              class = "text-end"
            ),
            shiny::plotOutput("summarise_indication_ggplot2_29")
          )
        )
      )
    )
  ),
  bslib::nav_panel(
    title = "Drug utilisation",
    icon = shiny::icon("capsules"),
    bslib::layout_sidebar(
      sidebar = bslib::sidebar(
        bslib::accordion(
          bslib::accordion_panel(
            title = "Settings",
            shinyWidgets::pickerInput(
              inputId = "summarise_drug_utilisation_settings_censor_date",
              label = "Censor date",
              choices = filterValues$summarise_drug_utilisation_settings_censor_date,
              selected = filterValues$summarise_drug_utilisation_settings_censor_date,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_drug_utilisation_settings_cohort_table_name",
              label = "Cohort table name",
              choices = filterValues$summarise_drug_utilisation_settings_cohort_table_name,
              selected = filterValues$summarise_drug_utilisation_settings_cohort_table_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_drug_utilisation_settings_gap_era",
              label = "Gap era",
              choices = filterValues$summarise_drug_utilisation_settings_gap_era,
              selected = filterValues$summarise_drug_utilisation_settings_gap_era,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_drug_utilisation_settings_index_date",
              label = "Index date",
              choices = filterValues$summarise_drug_utilisation_settings_index_date,
              selected = filterValues$summarise_drug_utilisation_settings_index_date,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_drug_utilisation_settings_restrict_incident",
              label = "Restrict incident",
              choices = filterValues$summarise_drug_utilisation_settings_restrict_incident,
              selected = filterValues$summarise_drug_utilisation_settings_restrict_incident,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          ),
          bslib::accordion_panel(
            title = "Grouping",
            shinyWidgets::pickerInput(
              inputId = "summarise_drug_utilisation_grouping_cdm_name",
              label = "Cdm name",
              choices = filterValues$summarise_drug_utilisation_grouping_cdm_name,
              selected = filterValues$summarise_drug_utilisation_grouping_cdm_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_drug_utilisation_grouping_cohort_name",
              label = "Cohort name",
              choices = filterValues$summarise_drug_utilisation_grouping_cohort_name,
              selected = filterValues$summarise_drug_utilisation_grouping_cohort_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_drug_utilisation_grouping_age_group",
              label = "Age group",
              choices = filterValues$summarise_drug_utilisation_grouping_age_group,
              selected = filterValues$summarise_drug_utilisation_grouping_age_group,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_drug_utilisation_grouping_sex",
              label = "Sex",
              choices = filterValues$summarise_drug_utilisation_grouping_sex,
              selected = filterValues$summarise_drug_utilisation_grouping_sex,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_drug_utilisation_grouping_concept_set",
              label = "Concept set",
              choices = filterValues$summarise_drug_utilisation_grouping_concept_set,
              selected = filterValues$summarise_drug_utilisation_grouping_concept_set[1],
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_drug_utilisation_grouping_ingredient",
              label = "Ingredient",
              choices = filterValues$summarise_drug_utilisation_grouping_ingredient,
              selected = filterValues$summarise_drug_utilisation_grouping_ingredient,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          ),
          bslib::accordion_panel(
            title = "Variables",
            shinyWidgets::pickerInput(
              inputId = "summarise_drug_utilisation_variable_name",
              label = "Variable name",
              choices = filterValues$summarise_drug_utilisation_variable_name,
              selected = filterValues$summarise_drug_utilisation_variable_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          ),
          bslib::accordion_panel(
            title = "Estimates",
            shinyWidgets::pickerInput(
              inputId = "summarise_drug_utilisation_estimate_name",
              label = "Estimate name",
              choices = filterValues$summarise_drug_utilisation_estimate_name,
              selected = filterValues$summarise_drug_utilisation_estimate_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          )
        )
      ),
      bslib::navset_card_tab(
        bslib::nav_panel(
          title = "Tidy",
          bslib::card(
            full_screen = TRUE,
            bslib::card_header(
              bslib::popover(
                shiny::icon("download"),
                shiny::downloadButton(outputId = "summarise_drug_utilisation_tidy_download", label = "Download csv")
              ),
              class = "text-end"
            ),
            bslib::layout_sidebar(
              sidebar = bslib::sidebar(
                shinyWidgets::pickerInput(
                  inputId = "summarise_drug_utilisation_tidy_columns",
                  label = "Columns",
                  choices = filterValues$summarise_drug_utilisation_tidy_columns,
                  selected = filterValues$summarise_drug_utilisation_tidy_columns,
                  multiple = TRUE,
                  options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                ),
                shiny::radioButtons(
                  inputId = "summarise_drug_utilisation_tidy_pivot",
                  label = "Pivot estimates/variables",
                  choices = c("none", "estimates", "estimates and variables"),
                  selected = "none"
                ),
                position = "right"
              ),
              DT::dataTableOutput("summarise_drug_utilisation_tidy")
            )
          )
        ),
        bslib::nav_panel(
          title = "Table drug utilisation",
          bslib::card(
            full_screen = TRUE,
            bslib::card_header(
              bslib::popover(
                shiny::icon("download"),
                shinyWidgets::pickerInput(
                  inputId = "summarise_drug_utilisation_gt_27_download_type",
                  label = "File type",
                  selected = "docx",
                  choices = c("docx", "png", "pdf", "html"),
                  multiple = FALSE
                ),
                shiny::downloadButton(outputId = "summarise_drug_utilisation_gt_27_download", label = "Download")
              ),
              class = "text-end"
            ),
            gt::gt_output("summarise_drug_utilisation_gt_27")
          )
        )
      )
    )
  ),
  bslib::nav_panel(
    title = "Proportion of patients covered",
    icon = shiny::icon("chart-gantt"),
    bslib::layout_sidebar(
      sidebar = bslib::sidebar(
        bslib::accordion(
          bslib::accordion_panel(
            title = "Settings",
            shinyWidgets::pickerInput(
              inputId = "summarise_proportion_of_patients_covered_settings_cohort_table_name",
              label = "Cohort table name",
              choices = filterValues$summarise_proportion_of_patients_covered_settings_cohort_table_name,
              selected = filterValues$summarise_proportion_of_patients_covered_settings_cohort_table_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          ),
          bslib::accordion_panel(
            title = "Grouping",
            shinyWidgets::pickerInput(
              inputId = "summarise_proportion_of_patients_covered_grouping_cdm_name",
              label = "Cdm name",
              choices = filterValues$summarise_proportion_of_patients_covered_grouping_cdm_name,
              selected = filterValues$summarise_proportion_of_patients_covered_grouping_cdm_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_proportion_of_patients_covered_grouping_cohort_name",
              label = "Cohort name",
              choices = filterValues$summarise_proportion_of_patients_covered_grouping_cohort_name,
              selected = filterValues$summarise_proportion_of_patients_covered_grouping_cohort_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_proportion_of_patients_covered_grouping_age_group",
              label = "Age group",
              choices = filterValues$summarise_proportion_of_patients_covered_grouping_age_group,
              selected = filterValues$summarise_proportion_of_patients_covered_grouping_age_group,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_proportion_of_patients_covered_grouping_sex",
              label = "Sex",
              choices = filterValues$summarise_proportion_of_patients_covered_grouping_sex,
              selected = filterValues$summarise_proportion_of_patients_covered_grouping_sex,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_proportion_of_patients_covered_grouping_time",
              label = "Time",
              choices = filterValues$summarise_proportion_of_patients_covered_grouping_time,
              selected = filterValues$summarise_proportion_of_patients_covered_grouping_time,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          ),
          bslib::accordion_panel(
            title = "Variables",
            shinyWidgets::pickerInput(
              inputId = "summarise_proportion_of_patients_covered_variable_name",
              label = "Variable name",
              choices = filterValues$summarise_proportion_of_patients_covered_variable_name,
              selected = filterValues$summarise_proportion_of_patients_covered_variable_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          ),
          bslib::accordion_panel(
            title = "Estimates",
            shinyWidgets::pickerInput(
              inputId = "summarise_proportion_of_patients_covered_estimate_name",
              label = "Estimate name",
              choices = filterValues$summarise_proportion_of_patients_covered_estimate_name,
              selected = filterValues$summarise_proportion_of_patients_covered_estimate_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          )
        )
      ),
      bslib::navset_card_tab(
        bslib::nav_panel(
          title = "Tidy",
          bslib::card(
            full_screen = TRUE,
            bslib::card_header(
              bslib::popover(
                shiny::icon("download"),
                shiny::downloadButton(outputId = "summarise_proportion_of_patients_covered_tidy_download", label = "Download csv")
              ),
              class = "text-end"
            ),
            bslib::layout_sidebar(
              sidebar = bslib::sidebar(
                shinyWidgets::pickerInput(
                  inputId = "summarise_proportion_of_patients_covered_tidy_columns",
                  label = "Columns",
                  choices = filterValues$summarise_proportion_of_patients_covered_tidy_columns,
                  selected = filterValues$summarise_proportion_of_patients_covered_tidy_columns,
                  multiple = TRUE,
                  options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                ),
                shiny::radioButtons(
                  inputId = "summarise_proportion_of_patients_covered_tidy_pivot",
                  label = "Pivot estimates/variables",
                  choices = c("none", "estimates", "estimates and variables"),
                  selected = "none"
                ),
                position = "right"
              ),
              DT::dataTableOutput("summarise_proportion_of_patients_covered_tidy")
            )
          )
        ),
        bslib::nav_panel(
          title = "Table PPC",
          bslib::card(
            full_screen = TRUE,
            bslib::card_header(
              bslib::popover(
                shiny::icon("download"),
                shinyWidgets::pickerInput(
                  inputId = "summarise_proportion_of_patients_covered_gt_30_download_type",
                  label = "File type",
                  selected = "docx",
                  choices = c("docx", "png", "pdf", "html"),
                  multiple = FALSE
                ),
                shiny::downloadButton(outputId = "summarise_proportion_of_patients_covered_gt_30_download", label = "Download")
              ),
              class = "text-end"
            ),
            gt::gt_output("summarise_proportion_of_patients_covered_gt_30")
          )
        ),
        bslib::nav_panel(
          title = "Plot PPC",
          bslib::card(
            full_screen = TRUE,
            bslib::card_header(
              bslib::popover(
                shiny::icon("download"),
                shiny::numericInput(
                  inputId = "summarise_proportion_of_patients_covered_ggplot2_31_download_width",
                  label = "Width",
                  value = 15
                ),
                shiny::numericInput(
                  inputId = "summarise_proportion_of_patients_covered_ggplot2_31_download_height",
                  label = "Height",
                  value = 10
                ),
                shinyWidgets::pickerInput(
                  inputId = "summarise_proportion_of_patients_covered_ggplot2_31_download_units",
                  label = "Units",
                  selected = "cm",
                  choices = c("px", "cm", "inch"),
                  multiple = FALSE
                ),
                shiny::numericInput(
                  inputId = "summarise_proportion_of_patients_covered_ggplot2_31_download_dpi",
                  label = "dpi",
                  value = 300
                ),
                shiny::downloadButton(outputId = "summarise_proportion_of_patients_covered_ggplot2_31_download", label = "Download")
              ),
              class = "text-end"
            ),
            shiny::plotOutput("summarise_proportion_of_patients_covered_ggplot2_31")
          )
        )
      )
    )
  ),
  bslib::nav_panel(
    title = "Alternative treatments",
    icon = shiny::icon("chart-bar"),
    bslib::layout_sidebar(
      sidebar = bslib::sidebar(
        bslib::accordion(
          bslib::accordion_panel(
            title = "Settings",
            shinyWidgets::pickerInput(
              inputId = "summarise_treatment_settings_censor_date",
              label = "Censor date",
              choices = filterValues$summarise_treatment_settings_censor_date,
              selected = filterValues$summarise_treatment_settings_censor_date,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_treatment_settings_cohort_table_name",
              label = "Cohort table name",
              choices = filterValues$summarise_treatment_settings_cohort_table_name,
              selected = filterValues$summarise_treatment_settings_cohort_table_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_treatment_settings_index_date",
              label = "Index date",
              choices = filterValues$summarise_treatment_settings_index_date,
              selected = filterValues$summarise_treatment_settings_index_date,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_treatment_settings_mutually_exclusive",
              label = "Mutually exclusive",
              choices = filterValues$summarise_treatment_settings_mutually_exclusive,
              selected = filterValues$summarise_treatment_settings_mutually_exclusive,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_treatment_settings_treatment_cohort_name",
              label = "Treatment cohort name",
              choices = filterValues$summarise_treatment_settings_treatment_cohort_name,
              selected = filterValues$summarise_treatment_settings_treatment_cohort_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          ),
          bslib::accordion_panel(
            title = "Grouping",
            shinyWidgets::pickerInput(
              inputId = "summarise_treatment_grouping_cdm_name",
              label = "Cdm name",
              choices = filterValues$summarise_treatment_grouping_cdm_name,
              selected = filterValues$summarise_treatment_grouping_cdm_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_treatment_grouping_cohort_name",
              label = "Cohort name",
              choices = filterValues$summarise_treatment_grouping_cohort_name,
              selected = filterValues$summarise_treatment_grouping_cohort_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_treatment_grouping_age_group",
              label = "Age group",
              choices = filterValues$summarise_treatment_grouping_age_group,
              selected = filterValues$summarise_treatment_grouping_age_group[1],
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_treatment_grouping_sex",
              label = "Sex",
              choices = filterValues$summarise_treatment_grouping_sex,
              selected = filterValues$summarise_treatment_grouping_sex,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_treatment_grouping_window_name",
              label = "Window name",
              choices = filterValues$summarise_treatment_grouping_window_name,
              selected = filterValues$summarise_treatment_grouping_window_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          ),
          bslib::accordion_panel(
            title = "Variables",
            shinyWidgets::pickerInput(
              inputId = "summarise_treatment_variable_name",
              label = "Variable name",
              choices = filterValues$summarise_treatment_variable_name,
              selected = filterValues$summarise_treatment_variable_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          ),
          bslib::accordion_panel(
            title = "Estimates",
            shinyWidgets::pickerInput(
              inputId = "summarise_treatment_estimate_name",
              label = "Estimate name",
              choices = filterValues$summarise_treatment_estimate_name,
              selected = filterValues$summarise_treatment_estimate_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          )
        )
      ),
      bslib::navset_card_tab(
        bslib::nav_panel(
          title = "Tidy",
          bslib::card(
            full_screen = TRUE,
            bslib::card_header(
              bslib::popover(
                shiny::icon("download"),
                shiny::downloadButton(outputId = "summarise_treatment_tidy_download", label = "Download csv")
              ),
              class = "text-end"
            ),
            bslib::layout_sidebar(
              sidebar = bslib::sidebar(
                shinyWidgets::pickerInput(
                  inputId = "summarise_treatment_tidy_columns",
                  label = "Columns",
                  choices = filterValues$summarise_treatment_tidy_columns,
                  selected = filterValues$summarise_treatment_tidy_columns,
                  multiple = TRUE,
                  options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                ),
                shiny::radioButtons(
                  inputId = "summarise_treatment_tidy_pivot",
                  label = "Pivot estimates/variables",
                  choices = c("none", "estimates", "estimates and variables"),
                  selected = "none"
                ),
                position = "right"
              ),
              DT::dataTableOutput("summarise_treatment_tidy")
            )
          )
        ),
        bslib::nav_panel(
          title = "Table treatments",
          bslib::card(
            full_screen = TRUE,
            bslib::card_header(
              bslib::popover(
                shiny::icon("download"),
                shinyWidgets::pickerInput(
                  inputId = "summarise_treatment_gt_32_download_type",
                  label = "File type",
                  selected = "docx",
                  choices = c("docx", "png", "pdf", "html"),
                  multiple = FALSE
                ),
                shiny::downloadButton(outputId = "summarise_treatment_gt_32_download", label = "Download")
              ),
              class = "text-end"
            ),
            gt::gt_output("summarise_treatment_gt_32")
          )
        ),
        bslib::nav_panel(
          title = "Plot treatments",
          bslib::card(
            full_screen = TRUE,
            bslib::card_header(
              bslib::popover(
                shiny::icon("download"),
                shiny::numericInput(
                  inputId = "summarise_treatment_ggplot2_33_download_width",
                  label = "Width",
                  value = 15
                ),
                shiny::numericInput(
                  inputId = "summarise_treatment_ggplot2_33_download_height",
                  label = "Height",
                  value = 10
                ),
                shinyWidgets::pickerInput(
                  inputId = "summarise_treatment_ggplot2_33_download_units",
                  label = "Units",
                  selected = "cm",
                  choices = c("px", "cm", "inch"),
                  multiple = FALSE
                ),
                shiny::numericInput(
                  inputId = "summarise_treatment_ggplot2_33_download_dpi",
                  label = "dpi",
                  value = 300
                ),
                shiny::downloadButton(outputId = "summarise_treatment_ggplot2_33_download", label = "Download")
              ),
              class = "text-end"
            ),
            shiny::plotOutput("summarise_treatment_ggplot2_33")
          )
        )
      )
    )
  ),
  bslib::nav_panel(
    title = "Drug restart",
    icon = shiny::icon("tablets"),
    bslib::layout_sidebar(
      sidebar = bslib::sidebar(
        bslib::accordion(
          bslib::accordion_panel(
            title = "Settings",
            shinyWidgets::pickerInput(
              inputId = "summarise_drug_restart_settings_cohort_table_name",
              label = "Cohort table name",
              choices = filterValues$summarise_drug_restart_settings_cohort_table_name,
              selected = filterValues$summarise_drug_restart_settings_cohort_table_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_drug_restart_settings_incident",
              label = "Incident",
              choices = filterValues$summarise_drug_restart_settings_incident,
              selected = filterValues$summarise_drug_restart_settings_incident,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_drug_restart_settings_restrict_to_first_discontinuation",
              label = "Restrict to first discontinuation",
              choices = filterValues$summarise_drug_restart_settings_restrict_to_first_discontinuation,
              selected = filterValues$summarise_drug_restart_settings_restrict_to_first_discontinuation,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_drug_restart_settings_switch_cohort_table",
              label = "Switch cohort table",
              choices = filterValues$summarise_drug_restart_settings_switch_cohort_table,
              selected = filterValues$summarise_drug_restart_settings_switch_cohort_table,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          ),
          bslib::accordion_panel(
            title = "Grouping",
            shinyWidgets::pickerInput(
              inputId = "summarise_drug_restart_grouping_cdm_name",
              label = "Cdm name",
              choices = filterValues$summarise_drug_restart_grouping_cdm_name,
              selected = filterValues$summarise_drug_restart_grouping_cdm_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_drug_restart_grouping_cohort_name",
              label = "Cohort name",
              choices = filterValues$summarise_drug_restart_grouping_cohort_name,
              selected = filterValues$summarise_drug_restart_grouping_cohort_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_drug_restart_grouping_age_group",
              label = "Age group",
              choices = filterValues$summarise_drug_restart_grouping_age_group,
              selected = filterValues$summarise_drug_restart_grouping_age_group,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_drug_restart_grouping_sex",
              label = "Sex",
              choices = filterValues$summarise_drug_restart_grouping_sex,
              selected = filterValues$summarise_drug_restart_grouping_sex,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            ),
            shinyWidgets::pickerInput(
              inputId = "summarise_drug_restart_grouping_follow_up_days",
              label = "Follow up days",
              choices = filterValues$summarise_drug_restart_grouping_follow_up_days,
              selected = filterValues$summarise_drug_restart_grouping_follow_up_days,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          ),
          bslib::accordion_panel(
            title = "Variables",
            shinyWidgets::pickerInput(
              inputId = "summarise_drug_restart_variable_name",
              label = "Variable name",
              choices = filterValues$summarise_drug_restart_variable_name,
              selected = filterValues$summarise_drug_restart_variable_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          ),
          bslib::accordion_panel(
            title = "Estimates",
            shinyWidgets::pickerInput(
              inputId = "summarise_drug_restart_estimate_name",
              label = "Estimate name",
              choices = filterValues$summarise_drug_restart_estimate_name,
              selected = filterValues$summarise_drug_restart_estimate_name,
              multiple = TRUE,
              options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
            )
          )
        )
      ),
      bslib::navset_card_tab(
        bslib::nav_panel(
          title = "Tidy",
          bslib::card(
            full_screen = TRUE,
            bslib::card_header(
              bslib::popover(
                shiny::icon("download"),
                shiny::downloadButton(outputId = "summarise_drug_restart_tidy_download", label = "Download csv")
              ),
              class = "text-end"
            ),
            bslib::layout_sidebar(
              sidebar = bslib::sidebar(
                shinyWidgets::pickerInput(
                  inputId = "summarise_drug_restart_tidy_columns",
                  label = "Columns",
                  choices = filterValues$summarise_drug_restart_tidy_columns,
                  selected = filterValues$summarise_drug_restart_tidy_columns,
                  multiple = TRUE,
                  options = list(`actions-box` = TRUE, size = 10, `selected-text-format` = "count > 3")
                ),
                shiny::radioButtons(
                  inputId = "summarise_drug_restart_tidy_pivot",
                  label = "Pivot estimates/variables",
                  choices = c("none", "estimates", "estimates and variables"),
                  selected = "none"
                ),
                position = "right"
              ),
              DT::dataTableOutput("summarise_drug_restart_tidy")
            )
          )
        ),
        bslib::nav_panel(
          title = "Table drug restart",
          bslib::card(
            full_screen = TRUE,
            bslib::card_header(
              bslib::popover(
                shiny::icon("download"),
                shinyWidgets::pickerInput(
                  inputId = "summarise_drug_restart_gt_25_download_type",
                  label = "File type",
                  selected = "docx",
                  choices = c("docx", "png", "pdf", "html"),
                  multiple = FALSE
                ),
                shiny::downloadButton(outputId = "summarise_drug_restart_gt_25_download", label = "Download")
              ),
              class = "text-end"
            ),
            gt::gt_output("summarise_drug_restart_gt_25")
          )
        ),
        bslib::nav_panel(
          title = "Plot drug restart",
          bslib::card(
            full_screen = TRUE,
            bslib::card_header(
              bslib::popover(
                shiny::icon("download"),
                shiny::numericInput(
                  inputId = "summarise_drug_restart_ggplot2_26_download_width",
                  label = "Width",
                  value = 15
                ),
                shiny::numericInput(
                  inputId = "summarise_drug_restart_ggplot2_26_download_height",
                  label = "Height",
                  value = 10
                ),
                shinyWidgets::pickerInput(
                  inputId = "summarise_drug_restart_ggplot2_26_download_units",
                  label = "Units",
                  selected = "cm",
                  choices = c("px", "cm", "inch"),
                  multiple = FALSE
                ),
                shiny::numericInput(
                  inputId = "summarise_drug_restart_ggplot2_26_download_dpi",
                  label = "dpi",
                  value = 300
                ),
                shiny::downloadButton(outputId = "summarise_drug_restart_ggplot2_26_download", label = "Download")
              ),
              class = "text-end"
            ),
            shiny::plotOutput("summarise_drug_restart_ggplot2_26")
          )
        )
      )
    )
  ),
  bslib::nav_spacer(),
  bslib::nav_item(
    bslib::popover(
      shiny::icon("download"),
      shiny::downloadButton(
        outputId = "download_raw",
        label = "Download raw data",
        icon = shiny::icon("download")
      )
    )
  ),
  bslib::nav_item(
    bslib::popover(
      shiny::icon("circle-info"),
      shiny::tags$img(
        src = "hds_logo.svg",
        class = "logo-img",
        alt = "Logo",
        height = "auto",
        width = "30%",
        style = "float:right"
      ),
      "This shiny app was generated with ",
      shiny::a(
        "OmopViewer",
        href = "https://github.com/OHDSI/OmopViewer",
        target = "_blank"
      ),
      shiny::strong("v0.2.0")
    )
  ),
  bslib::nav_item(bslib::input_dark_mode(id = "dark_mode", mode = "light"))
)
